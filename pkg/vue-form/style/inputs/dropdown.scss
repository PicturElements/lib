@use "~@qtxr/scss-utils" as *;

$dropdown-params: (
	"background",
	"error-background",
	"border",
	"error-border",
	"height",
	"padding",
	"mobile-padding",
	"separator-border"
);

@mixin dropdown(
	$background: white,
	$error-background: #ffe1e1,
	$border: 1px solid #dadada,
	$error-border: 1px solid #e02929,
	$height: 30px,
	$padding: 10px,
	$mobile-padding: 30px,
	$separator-border: 1px solid rgba(128, 128, 128, 0.25)
) {
	.inp-dropdown {
		position: relative;
		width: 100%;
		height: $height;
		max-width: 100%;
		font-size: 95%;
		border: $border;
		outline: none;
		text-align: left;
		padding: 0;
		background: $background;
		user-select: none;
	
		.mobi-focus,
		.focus-probe {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			border: none;
			outline: none;
			opacity: 0;
			cursor: pointer;
		}
	
		.mobi-focus {
			display: none;
		}
	
		.dropdown-option {
			line-height: $height;
			height: $height;
			padding: 0 $padding;
			white-space: nowrap;
			cursor: pointer;
	
			&.dropdown-active-option {
				padding-right: $height + $padding;
	
				> .dropdown-icon {
					position: absolute;
					top: 0;
					right: 0;
					height: 100%;
				}
			}
	
			&.selected .dropdown-option-inner {
				opacity: 0.5;
			}
	
			+ .dropdown-option {
				border-top: $separator-border;
			}
	
			.dropdown-option-inner {
				height: 100%;
			}
	
			.placeholder {
				opacity: 0.6;
				font-style: italic;
			}
		}
	
		.dropdown-list {
			display: none;
			position: absolute;
			box-sizing: content-box;
			border: inherit;
			background: inherit;
			overflow: auto;
		}
	
		&:not(.open):not(.error) {
			background: transparent !important;
		}
	
		&.open {
			.focus-probe {
				height: 0;
			}
	
			.dropdown-list {
				display: block;
				z-index: 10000000;
			}
		}
	
		&.error {
			&:not(.open) {
				background: $error-background;
				border: $error-border;
	
				.placeholder {
					opacity: 1;
				}
			}
		}
	}
	
	@include mobile {
		.inp-dropdown {
			&.open {
				.collapse-target {
					position: fixed;
					top: 0;
					left: 0;
					width: 100%;
					height: 100%;
					background: inherit;
					opacity: 0.8;
					z-index: 10000000;
				}
	
				.dropdown-list {
					position: fixed;
					top: 50%;
					left: $mobile-padding;
					right: $mobile-padding;
					width: auto;
					max-height: 90%;
					max-height: calc(100% - #{$mobile-padding * 2});
					transform: translateY(-50%);
					z-index: 10000001;
				}
			}
	
			.mobi-focus {
				display: block;
			}
	
			.focus-probe {
				display: none;
			}
		}
	}
}
